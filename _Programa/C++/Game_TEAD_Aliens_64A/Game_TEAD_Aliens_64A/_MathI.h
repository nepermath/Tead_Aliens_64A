/*
	/////////////////////////////////////////////////////////////////////////////////////////////////////
     
  	___  ___      _   _       _____      _                         _     _ _
	|  \/  |     | | | |     |_   _|    | |                       | |   (_) |
	| .  . | __ _| |_| |__     | | _ __ | |_ ___  __ _  ___ _ __  | |    _| |__  _ __ __ _ _ __ _   _
	| |\/| |/ _` | __| '_ \    | || '_ \| __/ _ \/ _` |/ _ \ '__| | |   | | '_ \| '__/ _` | '__| | | |
	| |  | | (_| | |_| | | |  _| || | | | ||  __/ (_| |  __/ |    | |___| | |_) | | | (_| | |  | |_| |
	\_|  |_/\__,_|\__|_| |_|  \___/_| |_|\__\___|\__, |\___|_|    \_____/_|_.__/|_|  \__,_|_|   \__, |
					        					  __/ |                                          __/ |
												  |___/                                          |___/
           
    //////////////////////////////////////////////////////////////////////////////////////////////////////
    ---------------------------------- HEADER FILE (tab 4)------------------------------------------------
*/
#ifndef _MATH_I_H_
#define _MATH_I_H_

/*
 +--------------------------------------+
 |        HARDWARE DEPENDENT INCLUDES	|
 +--------------------------------------+
*/

//DEFINITIONS FOR NEPERINO V2.50 AND V3.50
#include <avr/io.h>
#include <avr/interrupt.h>
#include <avr/eeprom.h>
#include <avr/pgmspace.h>

/*
 +--------------------------------------+
 |        C LIBRARY INCLUDES		    |
 +--------------------------------------+
*/
#include <stdlib.h>
#include <math.h>

/*
 +--------------------------------------+
 |        NAME SPACE NEPERINO		    |
 +--------------------------------------+
*/

/*
 +--------------------------------------+
 |        LOCAL LIBRARY INCLUDES	    |
 +--------------------------------------+
*/
/*
 +--------------------------------------+
 |        DEFINES				        |
 +--------------------------------------+
*/

#define LPMEM(var) pgm_get_far_address(var)

/*
 +--------------------------------------+
 |        TYPE DEFINITIONS		        |
 +--------------------------------------+
*/

typedef enum class PumpState:uint8_t
{
	MINIMUM=1,
	MAXIMUM=2,
	MID=3
}PumpState;
typedef enum class PumpType:uint8_t
{
	TYPE_TO_MIN,			//from max to min and stop
	TYPE_TO_MAX,			//from min to max and stop
	TYPE_CYCLE,				//from min to max and max to min and repeat
	TYPE_CYCLE_TO_MIN,		//from min to max and min again and repeat
	TYPE_CYCLE_TO_MAX		//form max to min and max again and repeat
}PumpType;

/*
 +--------------------------------------+
 |        CONSTANTS DEFINITIONS			|
 +--------------------------------------+
*/


/*
	+--------------------------------------+
	|       EXTERNAL DECLARATIONS          |
	+--------------------------------------+
*/

/*
        +-------------------------------------------------------+
        |        CLASS			Pump				            |
        +-------------------------------------------------------+
        | @PURPOSE      : make a variable pumped from min value |
		|				  max value and return from max value   |
		|				  to min value and repeat				|
        | @OBSERVATIONS :										|
        +-------------------------------------------------------+
*/


class class_Math_Integer
{
		/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
private:
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
        */
        /*
         +--------------------------------------+
         |        PUBLIC VARIABLES		        |
         +--------------------------------------+
        */
public:	
		/************************************************************************/
		/* Constructor default                                                  */
		/************************************************************************/
		class_Math_Integer(void);
		/************************************************************************/
		/* Constructor for initial values                                        */
		/************************************************************************/
		class_Math_Integer(int xCenter,int yCenter,int Angle);
		~class_Math_Integer(void);
		/*
         +--------------------------------------+
         |       PUBBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
		/************************************************************************/
		/* Vector Sine Function                                                 */
		/* return vector*sin(angle)												*/
		/************************************************************************/
		static int	vectorSin(int vector,int angle);
		/************************************************************************/
		/* Vector CoSine Function                                               */
		/* return vector*cos(angle)												*/
		/************************************************************************/
		static int	vectorCos(int vector,int angle);
		/************************************************************************/
		/* Square root of integer number                                        */
		/************************************************************************/
		uint16_t sqrtInt(uint16_t numberValue);
		/************************************************************************/
		/* Rotate Arc Point x,y with radius and angle and return rotated point  */
		/* int px,py                                                            */
		/************************************************************************/
		static void rotateArc(int x,int y,int radius_x,int radius_y,int angle,int &px,int &py);
};
/*
        +-------------------------------------------------------+
        |        CLASS			Pump				            |
        +-------------------------------------------------------+
        | @PURPOSE      : make a variable pumped from min value |
		|				  max value and return from max value   |
		|				  to min value and repeat				|
        | @OBSERVATIONS :										|
        +-------------------------------------------------------+
*/


class class_Pump
{
		/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
private:
		int pMin,pMax;
		int pValue;
		int pStep=1;
		PumpType pPumpType=PumpType::TYPE_CYCLE;
		bool pbPumping=true;
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
        */
        /*
         +--------------------------------------+
         |        PUBLIC VARIABLES		        |
         +--------------------------------------+
        */
public:	
		/************************************************************************/
		/* Constructor default                                                  */
		/************************************************************************/
		class_Pump();
		/************************************************************************/
		/* Construtor for initial values                                        */
		/************************************************************************/
		class_Pump(PumpType pumpType,int initialValue,int minValue,int maxValue,int Step=1);
		~class_Pump();
		/*
         +--------------------------------------+
         |       PUBBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
		/************************************************************************/
		/* Initialize Pump Vars                                                 */
		/************************************************************************/
		void init(PumpType pumpType,int initialValue,int minValue,int maxValue,int Step);
		/************************************************************************/
		/* get Minimal value from pump                                          */
		/************************************************************************/
		int getMin(void);
		/************************************************************************/
		/* get Maximum value from pump                                          */
		/************************************************************************/
		int getMax(void);
		/************************************************************************/
		/* get Step from pump                                                   */
		/************************************************************************/
		int getStep(void);
		/************************************************************************/
		/* get Value from pump                                                  */
		/************************************************************************/
		int getValue(void);
		/************************************************************************/
		/* Set minimum value of pump                                            */
		/************************************************************************/
		void setMin(int minValue);
		/************************************************************************/
		/* Set maximum value of pump                                            */
		/************************************************************************/
		void setMax(int maxValue);
		/************************************************************************/
		/* Set step value of pump                                               */
		/************************************************************************/
		void setStep(int stepValue);
		/************************************************************************/
		/* Set value of pump                                                    */
		/************************************************************************/
		void setValue(int value);
		/************************************************************************/
		/* pump get state                                                       */
		/* return 1 if value=min value											*/
		/* return 2 if value=max value											*/
		/* otherwise return 0													*/
		/************************************************************************/
		PumpState getState(void);
		/************************************************************************/
		/* get pump value from min                                              */
		/************************************************************************/
		int getDeltaMin(void);
		/************************************************************************/
		/* get pump value from max                                              */
		/************************************************************************/
		int getDeltaMax(void);
		/************************************************************************/
		/* Set Pump Type                                                        */
		/************************************************************************/
		void setPumpType(PumpType pumpType);
		/************************************************************************/
		/* Get Pump Type                                                        */
		/************************************************************************/
		PumpType getPumpType(void);
		/************************************************************************/
		/* Pump the Pump                                                        */
		/* pump value is incremented of decremented depend on pump state		*/
		/************************************************************************/
		void pump(void);
		/************************************************************************/
		/* Change Pump Direction                                                */
		/************************************************************************/
		void changeDir(void);
		/************************************************************************/
		/* Stop pump                                                            */
		/************************************************************************/
		void stop(void);
		/************************************************************************/
		/* restar pump                                                          */
		/************************************************************************/
		void restart(void);
};

/*
        +-------------------------------------------------------+
        |        CLASS			Pump				            |
        +-------------------------------------------------------+
        | @PURPOSE      : make a variable pumped from min value |
		|				  max value and return from max value   |
		|				  to min value and repeat				|
        | @OBSERVATIONS :										|
        +-------------------------------------------------------+
*/


class class_Rotate
{
		/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
private:
		int rotCenterX=0,
			rotCenterY=0;
		int rotAngle=0;
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
        */
        /*
         +--------------------------------------+
         |        PUBLIC VARIABLES		        |
         +--------------------------------------+
        */
public:	
		/************************************************************************/
		/* Constructor default                                                  */
		/************************************************************************/
		class_Rotate(void);
		/************************************************************************/
		/* Construtor for initial values                                        */
		/************************************************************************/
		class_Rotate(int xCenter,int yCenter,int Angle);
		~class_Rotate(void);
		/*
         +--------------------------------------+
         |       PUBBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
		/************************************************************************/
		/* Set rotate Center cx,cy                                              */
		/************************************************************************/
		void setCenter(int cx,int cy);
		/************************************************************************/
		/* Get rotate Center                                                    */
		/************************************************************************/
		void getCenter(int &cx,int &cy);
		/************************************************************************/
		/* Set rotate angle in degree                                           */
		/************************************************************************/
		void setAngle(int angle);
		/************************************************************************/
		/* Get rotate angle                                                     */
		/************************************************************************/
		int getAngle(void);
		/************************************************************************/
		/* Rotate point x,y at center cx,cy and angle in degree                 */
		/* rotated point returned in xRot and yRot								*/
		/* set rotate center using rotateSetCenter function						*/
		/* set rotate Angle using rotateSetAngle function						*/
		/************************************************************************/
		void rotate(int x,int y,int &xRot,int &yRot);
};
						 
/*
        +-------------------------------------------------------+
        |        CLASS	LINE DDA			                    |
        +-------------------------------------------------------+
        | @PURPOSE      : Static Integer Math Routines		    |
        | @OBSERVATIONS :										|
        +-------------------------------------------------------+
*/

class class_LineDDA
{
		/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
 private:
		int d;
		int x,y;
		int xd,yd;
		int xn,yn;
		int k,j;
		int ct;
		int x0,y0,x1,y1;
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
		*/
        /*
         +--------------------------------------+
         |        PUBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
public:
	
        /************************************************************************/
        /* Constructor                                                          */
        /************************************************************************/
        class_LineDDA(void);
		/************************************************************************/
		/* Constructor #2 with line parameters xi,yi,xf,yf						*/
		/************************************************************************/
		class_LineDDA(int xi,int yi,int xf,int yf);
		/************************************************************************/
		/* Destructor                                                           */
		/************************************************************************/
		~class_LineDDA(void);
		/************************************************************************/
		/* Set Coordinates line DDA(Digital Differential Analyzer)              */
		/* from point xi,yi to xf,yf											*/
		/************************************************************************/
		void setCoords(int xi,int yi,int xf,int yf);
		/************************************************************************/
		/* get Coordinates                                                      */
		/************************************************************************/
		void getCoords(int &xi,int &yi,int &xf,int &yf);
		/************************************************************************/
		/* Get line DDA Point return true if last point reach                   */
		/************************************************************************/
		bool getPoint(int &x,int &y);
		/************************************************************************/
		/* Get line DDA Next Point return true if last point reach              */
		/************************************************************************/
		bool getNextPoint(int &x,int &y,int step);
};	//class

#endif