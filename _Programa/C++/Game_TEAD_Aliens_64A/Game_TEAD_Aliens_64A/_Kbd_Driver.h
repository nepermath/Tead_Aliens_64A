/*
	//////////////////////////////////////////////////////////////////////////////////////////
 						  _   __            ______      _
 						 | | / /            |  _  \    (_)
 						 | |/ /  ___ _   _  | | | |_ __ ___   _____
 						 |    \ / _ \ | | | | | | | '__| \ \ / / _ \
 						 | |\  \  __/ |_| | | |/ /| |  | |\ V /  __/
 						 \_| \_/\___|\__, | |___/ |_|  |_| \_/ \___|
 						              __/ |
 						              |___/

    //////////////////////////////////////////////////////////////////////////////////////////
    ---------------------------------- HEADER FILE (tab 4)-----------------------------------
*/


#ifndef _KBD_DRIVER_H_
#define _KBD_DRIVER_H_



/*
 +--------------------------------------+
 |        HARDWARE DEPENDENT INCLUDES	|
 +--------------------------------------+
*/
#include <avr/io.h>
#include <avr/interrupt.h>
#include <util/delay.h>

/*
 +--------------------------------------+
 |        C LIBRARY INCLUDES		    |
 +--------------------------------------+
*/

/*
 +--------------------------------------+
 |        LOCAL LIBRARY INCLUDES	    |
 +--------------------------------------+
*/
#include "_Port.h"
#include "_ADC_Driver.h"
/*
 +--------------------------------------+
 |        PORTS AND PIN DEFINITIONS	    |
 +--------------------------------------+
*/


	#define		_KEY_PORT_OUTPUT		PORTB
	#define		_KEY_PORT_DIR			DDRB
	#define		_KEY_PORT_INPUT			PINB

	//low means key pressed
	#define		_KEY_A_PIN			6
	#define		_KEY_B_PIN			5


/*
 +--------------------------------------+
 |        TYPEDEFS			         	|
 +--------------------------------------+
*/
typedef enum class Kbd:uint8_t
{
	NONE =0,
	LEFT =(1<<0),
	ENTER=(1<<1),
	RIGHT=(1<<2),
	UP   =(1<<3),
	DOWN =(1<<4),
	A	 =(1<<5),
	B	 =(1<<6),
}Kbd;


/*
	+--------------------------------------+
	|       EXTERNAL DECLARATIONS          |
	+--------------------------------------+
*/

						 
/*
        +-------------------------------------------------------+
        |        CLASS			KEY			                    |
        +-------------------------------------------------------+
        | @PURPOSE      : TO OBTAIN STATE OF THE KEY AND OTHER	|
		|				  FACILITIES							|
        | @OBSERVATIONS :										|
        +-------------------------------------------------------+
*/

class class_KBD
{
/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
 private:
//		PORT		PortOut;
//		PORT		PortDir;
//		PORT		PortIn;
//		uint8_t		BitAKey;
//		uint8_t		BitBKey; 
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
        */
		void	Initialize(void);
		void	UnInitialize(void);
        /*
         +--------------------------------------+
         |        PUBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
public:
	
        /************************************************************************/
        /* Constructor                                                          */
        /************************************************************************/
        class_KBD(void);
		/************************************************************************/
		/* Constructor #2 with keyboard port and bit for key A and key B        */
		/************************************************************************/
		//class_KBD(PORT kbdPortOut,PORT kbdPortIn,PORT kbdPortDir,uint8_t bitKbdA=6,uint8_t bitKbdB=5);
		/************************************************************************/
		/* Destructor                                                           */
		/************************************************************************/
		~class_KBD(void);
		/************************************************************************/
		/* Get Keys State                                                       */
		/************************************************************************/		
		Kbd getKbdState();
		/************************************************************************/
		/* Wait Key release                                                     */
		/************************************************************************/
		void waitKbdRelease();
		/************************************************************************/
		/* Get Keys State ASCII                                                 */
		/* NORMAL KEYS															*/
		/*  0 - key NONE  ' ' SPACE											    */
		/*  1 - key LEFT  'L' LEFT											    */
		/*  2 - key ENTER 'E' ENTER											    */
		/*  4 - key RIGHT 'R' RIGHT											    */
		/*  8 - key UP    'U' UP											    */
		/* 16 - key DOWN  'D' DOWN											    */
		/*  3 - Key LEFT+ENTER  'X' DOWN									    */
		/*  6 - Key RIGHT+ENTER 'Y' DOWN									    */
		/* 10 - Key UP+ENTER    'T' DOWN									    */
		/* 18 - Key DOWN+ENTER  'Y' DOWN									    */
		/* 31 - ALL KEYS PRESSED 'A'											*/
		/* 32 - Key A 'A'														*/
		/* 64 - Key B 'B'														*/
		/*																		*/
		/* DIAGONAL KEYS														*/
		/*																		*/
		/*   +----------+-----+----------+										*/
		/*   | UP LEFT  |  UP | UP RIGHT |										*/
		/*   |    7     |   8 |    9     |										*/
		/*   +----------+-----+----------+										*/
		/*	 |  LEFT    |ENTER|  RIGHT   |										*/
		/*   |    4     |  5  |    6     |										*/
		/*   +----------+-----+----------+										*/
		/*   |DOWN LEFT |DONW |DONW RIGHT|										*/
		/*	 |    1     |  2  |     3    |										*/
		/*   +----------+-----+----------+										*/
		/*																	    */
		/************************************************************************/		
		char getKbdASCII(bool diagonals=false);	
};

#endif