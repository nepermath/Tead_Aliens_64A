/*
	//////////////////////////////////////////////////////////////////////////////////////////
			  _____ _                 _____ ___   _____   _____       _
			 / ____| |               |_   _|__ \ / ____| |  __ \     (_)
			| |    | | __ _ ___ ___    | |    ) | |      | |  | |_ __ ___   _____
			| |    | |/ _` / __/ __|   | |   / /| |      | |  | | '__| \ \ / / _ \
			| |____| | (_| \__ \__ \  _| |_ / /_| |____  | |__| | |  | |\ V /  __/
			 \_____|_|\__,_|___/___/ |_____|____|\_____| |_____/|_|  |_| \_/ \___|

    //////////////////////////////////////////////////////////////////////////////////////////
    ---------------------------------- HEADER FILE (tab 4)-----------------------------------
*/

#ifndef _I2C_DRIVER_H_
#define _I2C_DRIVER_H_

/*
 +--------------------------------------+
 |        HARDWARE DEPENDENT INCLUDES	|
 +--------------------------------------+
*/


#ifdef ESP8266
	#include <c_types.h>
	#include <Arduino.h>
#else
	#include <avr/io.h>
	#include <avr/interrupt.h>
	#include <util/delay.h>
#endif

/*
 +--------------------------------------+
 |        LOCAL INCLUDES			    |
 +--------------------------------------+
*/
#include "_Port.h"
/*
 +--------------------------------------+
 |        PORTS AND PIN DEFINITIONS	    |
 +--------------------------------------+
*/

//DEFINE I2C PINS FOR NEPERINO V3.50
#define		_I2C_PORT_OUTPUT		PORTE
#define		_I2C_PORT_DIR			DDRE
#define		_I2C_PORT_INPUT			PINE
	 
//low means key pressed
#define		_I2C_SCL				2
#define		_I2C_SDA				3
/*
 +--------------------------------------+
 |        TYPEDEF ENUMS				    |
 +--------------------------------------+
*/
typedef enum class I2CSpeed:uint8_t
{
	CLOCK_100KHZ,
	CLOCK_400KHZ,
	CLOCK_OTHER
}I2CSpeed;
/*
        +-------------------------------------------------------+
        |        CLASS		I2C				                    |
        +-------------------------------------------------------+
        | @PURPOSE      : CONTROL I2C LINE USING SOFTWARE		|
		|														|
        | @OBSERVATIONS : LINES SCL E SDA MUST BE IN SAME PORT	|
        +-------------------------------------------------------+
*/

class class_I2C
{
/*
         +--------------------------------------+
         |       PRIVATE VARIABLES		        |
         +--------------------------------------+
        */
 private:
		PORT output,input,dir;
		uint8_t pinSLC,pinSDA;
        /*
         +--------------------------------------+
         |       PRIVATE FUNCTIONS      	    |
         +--------------------------------------+
        */
		void	Initialize(void);
		void	UnInitialize(void);
		/************************************************************************/
		/* Delay 1us for                                                        */
		/************************************************************************/
		static void	I2C_Delay(void);
        /*
         +--------------------------------------+
         |        PUBLIC FUNCTIONS		        |
         +--------------------------------------+
        */
public:
	
        /************************************************************************/
        /* Constructor                                                          */
        /************************************************************************/
        class_I2C(void);
		/************************************************************************/
		/* Destructor                                                           */
		/************************************************************************/
		~class_I2C(void);
		/************************************************************************/
		/* Set I2C Delay (i.e I2C Transfer Speed)                               */
		/************************************************************************/
		static void	setDelay(uint8_t delayInMicroseconds);
		/************************************************************************/
		/* Set I2C Speed Transfer in Kbps                                       */
		/************************************************************************/
		static void setSpeed(I2CSpeed kbps);
		/************************************************************************/
		/* I2C issue Start condition                                            */
		/************************************************************************/
		static void	Start(void);
		/************************************************************************/
		/* I2C Issue Stop condition                                             */
		/************************************************************************/
		static void	Stop(void);
		/************************************************************************/
		/* I2C Bit Output 1=true 0=false                                        */
		/************************************************************************/
		static void	BitOut(uint8_t bitvalue);
		/************************************************************************/
		/* I2C Bit Input exit true=1 false=0                                    */
		/************************************************************************/
		static uint8_t	BitIn(void);
		/************************************************************************/
		/* Output a Byte at I2C Line                                            */
		/************************************************************************/
		static void	ByteOut(uint8_t data);
		/************************************************************************/
		/* get byte from I2C line                                               */
		/************************************************************************/
		static uint8_t	ByteIn(void);
		/************************************************************************/
		/* Get Ack Status 1 or 0                                                */
		/************************************************************************/
		static uint8_t AckIn();
		/************************************************************************/
		/* Send Ack Output  bitStatus is 0 or 1                                 */
		/************************************************************************/
		static void	AckOut(uint8_t bitStatus);
};




#endif /* _I2C_DRIVE_H_ */